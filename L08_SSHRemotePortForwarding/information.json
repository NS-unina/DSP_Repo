{"description":"Learn how to create an SSH tunnel with Remote Port Forwarding","goal":"","solution":"<p>The scenario is the same as Local Port Forwarding Lab. Only in this case we don't have any outbound traffic allowed, but the organization allows us to work from home if we set up proper SSH tunnels.</p>\n<p>This means that on our host at work we have an SSH server which waits for connections from an SSH client that we have at home.</p>\n<p>Let's go on our firefox client and start the SSH server</p>\n<p style=\"padding-left: 30px;\">$ /usr/sbin/sshd -D &amp;</p>\n<p>&nbsp;<img src=\"https://raw.githubusercontent.com/NS-unina/DSP_Repo/master/L08_SSHRemotePortForwarding/.images/sshd_start.png\" width=\"284\" height=\"58\" /></p>\n<p>Now we access to our SSH client and perform a Remote Port Forwarding</p>\n<p style=\"padding-left: 30px;\">$ ssh -R 9999:193.20.2.3:80 <a href=\"mailto:sshuser@193.20.4.3\">sshuser@193.20.4.3</a></p>\n<p><img src=\"https://raw.githubusercontent.com/NS-unina/DSP_Repo/master/L08_SSHRemotePortForwarding/.images/remote_port_forwarding.png\" width=\"685\" height=\"309\" /></p>\n<p>The syntax is pretty much the same as Local Port Forwarding, with the difference of the \"-R\" option instead of \"-L\".</p>\n<p>This way, we are connecting to the music server and redirecting all traffic to our workplace laptop, inside an SSH tunnel. The firewall allows for the connection to happen because it can't look inside the tunnel. Everything appears as a legitimate SSH connection over port 22. The workplace laptop, though, has an open socket binded on localhost:9999.</p>\n<p>We can launch netstat to check the state of the sockets on the firefox host:</p>\n<p style=\"padding-left: 30px;\">$ netstat -tulnp</p>\n<p><img src=\"https://raw.githubusercontent.com/NS-unina/DSP_Repo/master/L08_SSHRemotePortForwarding/.images/netstat.png\" width=\"911\" height=\"198\" />&nbsp;</p>\n<p>As you can see, the localhost is listening both on port 22 and 9999.</p>\n<p>We can check it out in our firefox client:</p>\n<p>&nbsp;<img src=\"https://raw.githubusercontent.com/NS-unina/DSP_Repo/master/L08_SSHRemotePortForwarding/.images/firefox_remote.png\" width=\"951\" height=\"575\" /></p>\n<p>Voil&agrave;!</p>","readme":"","difficulty":"Beginner","author":"NS"}
