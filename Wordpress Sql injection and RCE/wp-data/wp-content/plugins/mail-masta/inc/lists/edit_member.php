







			    <?php







			  	$list_id = $_GET['filter_list'];







				$member_id = $_GET['member_id'];







               //echo $list_id;







                global $wpdb;







              







             $masta_list = $wpdb->prefix . "masta_list";







		     $masta_subs = $wpdb->prefix . "masta_subscribers";







            // echo $list_id;







             $list_form_data = $wpdb->get_results( "SELECT * FROM $masta_list WHERE list_id = $list_id ");







			 $list_subs = $wpdb->get_results( "SELECT * FROM $masta_subs WHERE list_id = $list_id and id = $member_id");







			?>







			<div class="panel-heading clearfix">







			             Edit member(member of <a href="<?php echo admin_url(); ?>/admin.php?page=masta-lists&action=view_list&filter_list=<?php echo $list_id; ?>"> <?php echo $list_form_data[0]->list_name; ?></a>)







			           </div>







			           <div class="panel-body">







			           	<div class="container mm_form_style">







			<?php







		







             //echo count($list_form_data);







             if(count($list_form_data) > 0) {







				







				    $return_head = '<form method="POST" name="list_form_subscriber" id="list_form_subscriber" onsubmit="return false">







                 <div style="display:none;font-size: 18px;margin-bottom: 15px;margin-top: 10px;" id="sub_msg"></div>







											<div class="row">







												<div class="col-sm-2"><label>Email:</label> </div>







												<div class="col-sm-4"><input value="'.$list_subs[0]->email.'" type="text" class="validate[required,custom[email]] form-control" id="subscriber_email" name="subscriber_email" Placeholder="email@email.com"> </div>







											</div>







							        ';







				    $return_footer = '<input type="hidden" name="subscriber_list_id" id="subscriber_list_id" value="'.$list_id.'">







									<input type="hidden" name="member_list_id" id="member_list_id" value="'.$member_id.'">







											<div class="row">







												<div class="col-sm-2">&nbsp;</div>







												<div class="col-sm-4">







													<input type="submit" id="subscribe_campaign" name="subscribe_campaign" class="btn btn-success" value="update">







												</div>







											</div>







											<div id="sub_loading" style="display:none"><img src="'.plugins_url().'/mail-masta/lib/css/images/loading.gif" height="32" width="32"></div>







                                         <input type="hidden" name="server_url" id="server_url" value="'.home_url().'">
										 <input type="hidden" name="admin_url" id="admin_url" value="'.admin_url().'">







								        </form>';







				    $return_data = '';







					$row = $list_form_data[0];







					$rowdata=$list_subs[0];







					//print_r($row);







				    $list_form = $row->list_form;







					$validation = $row->validation;







					$edit_form = $row->edit_form;







					$subcri_data=$rowdata->subscriber_data;	







				    			







				  







						







						$docode_data = json_decode($list_form,true);







						$decode_validation=json_decode($validation,true);







						$decode_edit=json_decode($edit_form,true);







						$decode_subs=json_decode($subcri_data,true);







					







						







						$ij=0;







						foreach($decode_edit as $key=>$val){







							$deed[$ij++]=$key;	







						}







							







						if(is_array($docode_data) && !empty($docode_data)) {







							$cnt = 1;







							$ij=0;







						    foreach($docode_data as $key=>$val)://main foreach start here







						      $return_data .= '<div class="row"><div class="col-sm-2"><label>'.$deed[$ij++].':</label> </div>';







						      if(!is_array($val)) {







								  $vs="'".$decode_validation[$key]['form_req_message']."'";







								 $return_data .= '<div class="col-sm-4"><input value="'.$decode_subs[$key].'" type="text" class="form-control" id="'.mmasta_add_underscore($key).$cnt.'" onblur="myfunction(this,'.$decode_validation[$key]['form_req'].','.$vs.')"   name="'.mmasta_add_underscore($key).'"> </div></div>';







								} else {







									







									$return_data .= '<div class="col-sm-4">';







									$field_array = $val;







									$filed_type = array_shift( ( array_keys( $field_array ) ) );







									if($filed_type == 'radio') { //if type is radio then generate radio buttons.







										$label_array = $field_array[$filed_type];







										if(is_array($label_array)){







											 $ccnt = 1;







											 foreach($label_array as $value):







										   	    







										   	    $return_data .= '&nbsp;&nbsp;'.$value.'<input type="radio" name="'.mmasta_add_underscore($key).'" value="'.$value.'">';







										   	   $ccnt++;







										   	 endforeach;







										} 







									







									} elseif($filed_type == 'checkbox') { //if type is checkbox then generate chekboxes.







									    $label_array = $field_array[$filed_type];







										if(is_array($label_array)){







											 $ccnt = 1;







											 foreach($label_array as $value):







										   	    







										   	    $return_data .= '&nbsp;&nbsp;'.$value.'<input type="checkbox" name="'.mmasta_add_underscore($key).'[]" value="'.$value.'">';







										   	   $ccnt++;







										   	 endforeach;







										} 	







										







									}







									$return_data .= '</div>';







								}







								







						     $cnt++;







						    endforeach;//main foreach end here







					    	}







								$return_data .= '<div class="row" style="display:none"><div class="col-sm-2 valij"><input type="checkbox" name="ter" checked id="tre"><label>'.$row->terms_message.'</label></div></div>';







					$return_data .='<input type="hidden" id="subs" name="subs" value="" >';







						







						







				







					







					







					







					$main_return = $return_head.$return_data.$return_footer;







				







					







				} else {







				  echo 'invalid request';	







				} 







           	







				echo $main_return; ?>







            







         







			







                   







                   







                   







               </div><!--.container-->







               







               







               







           </div><!--.panel-body-->







